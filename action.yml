name: 'Docker Certificate Installer'
description: 'Install custom SSL/TLS certificates for Docker build environments'
author: 'LiquidLogicLabs'

branding:
  icon: 'shield'
  color: 'blue'

inputs:
  certificate-source:
    description: 'Certificate source: file path, URL, or "inline" for direct content'
    required: true
  
  certificate-body:
    description: 'Certificate content (required when certificate-source is "inline")'
    required: false
    default: ''
  
  certificate-name:
    description: 'Name for the certificate file (auto-generated if not specified)'
    required: false
    default: ''
  
  debug:
    description: 'Enable debug output'
    required: false
    default: 'false'
  
  generate-buildkit:
    description: 'Generate buildkit.toml configuration file with CA certificate settings'
    required: false
    default: 'false'

outputs:
  certificate-path:
    description: 'Path where the certificate was installed'
    value: ${{ steps.install-cert.outputs.certificate-path }}
  
  certificate-name:
    description: 'Name of the installed certificate file'
    value: ${{ steps.install-cert.outputs.certificate-name }}
  
  buildkit-path:
    description: 'Path to the generated buildkit.toml file (only set if generate-buildkit is true)'
    value: ${{ steps.install-cert.outputs.buildkit-path }}

runs:
  using: 'composite'
  steps:
    - name: Install certificate
      id: install-cert
      shell: bash
      run: ${{ github.action_path }}/install-certificate.sh
      env:
        INPUT_CERTIFICATE_SOURCE: ${{ inputs.certificate-source }}
        INPUT_CERTIFICATE_BODY: ${{ inputs.certificate-body }}
        INPUT_CERTIFICATE_NAME: ${{ inputs.certificate-name }}
        INPUT_DEBUG: ${{ inputs.debug }}
        INPUT_GENERATE_BUILDKIT: ${{ inputs.generate-buildkit }}

